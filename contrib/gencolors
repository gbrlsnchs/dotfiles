#!/bin/sh

background="1d1f21"
foreground="c5c8c6"
color0="282a2e"
color1="a54242"
color2="8c9440"
color3="de935f"
color4="5f819d"
color5="85678f"
color6="5e8d87"
color7="707880"
color8="373b41"
color9="cc6666"
color10="b5bd68"
color11="f0c674"
color12="81a2be"
color13="b294bb"
color14="8abeb7"
color15="$foreground"

MONITOR1="${MONITOR1:-DP-1}"
MONITOR1_W="${MONITOR1_RES:-2560}"
MONITOR1_H="${MONITOR1_RES:-1080}"
MONITOR1_POS="${MONITOR1_RES:-0,0}"
MONITOR2="${MONITOR2:-HDMI-A-1}"
MONITOR2_W="${MONITOR1:-1920}"
MONITOR2_H="${MONITOR1:-1080}"
MONITOR2_POS="${MONITOR2:-320,1080}"

CURSOR_THEME="${CURSOR_THEME:-Neutral_Plus}"
WALLPAPER="$(xdg-user-dir PICTURES)/wallpaper.png"

# Clean directories first.
for dir in templates/* ; do
	for template in $dir/* ; do
		outdir="$(dirname "$template")"

		outdir="$XDG_CACHE_HOME/dotfiles/$outdir"
		mkdir --parents "$outdir" || continue

		file="$outdir/$(basename "$template")"

		sed --expression "s/{{notice}}/This file was generated by a script, don't touch it!/g" \
			--expression "s/{{background}}/$background/g" \
			--expression "s/{{foreground}}/$foreground/g" \
			--expression "s/{{color0}}/$color0/g" \
			--expression "s/{{color1}}/$color1/g" \
			--expression "s/{{color2}}/$color2/g" \
			--expression "s/{{color3}}/$color3/g" \
			--expression "s/{{color4}}/$color4/g" \
			--expression "s/{{color5}}/$color5/g" \
			--expression "s/{{color6}}/$color6/g" \
			--expression "s/{{color7}}/$color7/g" \
			--expression "s/{{color8}}/$color8/g" \
			--expression "s/{{color9}}/$color9/g" \
			--expression "s/{{color10}}/$color10/g" \
			--expression "s/{{color11}}/$color11/g" \
			--expression "s/{{color12}}/$color12/g" \
			--expression "s/{{color13}}/$color13/g" \
			--expression "s/{{color14}}/$color14/g" \
			--expression "s/{{color15}}/$color15/g" \
			--expression "s/{{font_size}}/12/g" \
			--expression "s/{{primary_monitor}}/$MONITOR1/g" \
			--expression "s/{{primary_monitor_width}}/$MONITOR1_W/g" \
			--expression "s/{{primary_monitor_height}}/$MONITOR1_H/g" \
			--expression "s/{{primary_monitor_position}}/$MONITOR1_POS/g" \
			--expression "s/{{secondary_monitor}}/$MONITOR2/g" \
			--expression "s/{{secondary_monitor_width}}/$MONITOR2_W/g" \
			--expression "s/{{secondary_monitor_height}}/$MONITOR2_H/g" \
			--expression "s/{{secondary_monitor_position}}/$MONITOR2_POS/g" \
			--expression "s/{{cursor_theme}}/$CURSOR_THEME/g" \
			--expression "s|{{wallpaper}}|$WALLPAPER|g" \
			"$template" > "$file" || continue
		echo "Generated file from template: $file"
	done
done
