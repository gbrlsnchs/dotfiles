#!/bin/sh

background="ebdbb2"
foreground="282828"
color0="d5c4a1"
color1="cc241d"
color2="98971a"
color3="d79921"
color4="458588"
color5="b16286"
color6="689d6a"
color7="7c6f64"
color8="928374"
color9="9d0006"
color10="79740e"
color11="b57614"
color12="076678"
color13="8f3f71"
color14="427b58"
color15="3c3836"

MONITOR1="${MONITOR1:-DP-1}"
MONITOR2="${MONITOR2:-HDMI-A-1}"

# Clean directories first.
for template in **/template/*; do
	outdir=$(dirname "$template")
	outdir=$XDG_CACHE_HOME/dotfiles/${outdir%/template}

	mkdir -p "$outdir" || continue

	file="$outdir/$(basename "$template")"

	sed --expression "s/{{notice}}/This file was generated by a script, don't touch it!/g" \
		--expression "s/{{background}}/$background/g" \
		--expression "s/{{foreground}}/$foreground/g" \
		--expression "s/{{color0}}/$color0/g" \
		--expression "s/{{color1}}/$color1/g" \
		--expression "s/{{color2}}/$color2/g" \
		--expression "s/{{color3}}/$color3/g" \
		--expression "s/{{color4}}/$color4/g" \
		--expression "s/{{color5}}/$color5/g" \
		--expression "s/{{color6}}/$color6/g" \
		--expression "s/{{color7}}/$color7/g" \
		--expression "s/{{color8}}/$color8/g" \
		--expression "s/{{color9}}/$color9/g" \
		--expression "s/{{color10}}/$color10/g" \
		--expression "s/{{color11}}/$color11/g" \
		--expression "s/{{color12}}/$color12/g" \
		--expression "s/{{color13}}/$color13/g" \
		--expression "s/{{color14}}/$color14/g" \
		--expression "s/{{color15}}/$color15/g" \
		--expression "s/{{font_size}}/12/g" \
		--expression "s/{{primary_monitor}}/$MONITOR1/g" \
		--expression "s/{{secondary_monitor}}/$MONITOR2/g" \
		"$template" > "$file" || continue
	echo "Generated file from template: $file"
done
